<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Super Admin Panel</title>

<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ================= MODAL ================= */
.modal{
 display:none;
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.35);
 backdrop-filter:blur(2px);
 align-items:center;
 justify-content:center;
 z-index:1000;
}
.modal-card{
 background:#fff;
 padding:40px 30px 30px;
 border-radius:8px;
 max-width:700px;
 width:90%;
 max-height:90vh;
 overflow-y:auto;
 position:relative;
}
.close{
 position:absolute;
 top:12px;
 right:18px;
 font-size:26px;
 cursor:pointer;
 color:#666;
}
.close:hover{color:#000}

/* FORM */
.form-group{margin-bottom:15px}
.form-group label{
 display:block;
 margin-bottom:6px;
 font-weight:600;
}
.form-group input{
 width:100%;
 padding:10px;
 border:1px solid #ddd;
 border-radius:4px;
}

/* BUTTONS */
.btn-primary{
 background:#007bff;
 color:#fff;
 padding:12px;
 border:none;
 width:100%;
 border-radius:4px;
 cursor:pointer;
}
.create-admin-btn{
 background:#28a745;
 color:#fff;
 padding:12px 24px;
 border:none;
 border-radius:4px;
 cursor:pointer;
 margin-bottom:20px;
}
    /* ================= MODAL OVERLAY ================= */
.modal{
 display:none;
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.55);
 backdrop-filter: blur(6px);
 align-items:center;
 justify-content:center;
 z-index:9999;
 animation:fadeIn .25s ease;
}

/* ================= MODAL CARD ================= */
.modal-card{
 background:#fff;
 padding:35px 30px;
 border-radius:16px;
 max-width:720px;
 width:90%;
 max-height:90vh;
 overflow-y:auto;
 position:relative;
 box-shadow:0 20px 60px rgba(0,0,0,.35);
 animation:pop .25s ease;
}

/* CLOSE */
.close{
 position:absolute;
 top:14px;
 right:18px;
 font-size:26px;
 cursor:pointer;
 color:#888;
 transition:.2s;
}
.close:hover{
 color:#000;
 transform:rotate(90deg);
}

/* IMAGE */
#mImage{
 width:100%;
 max-height:320px;
 object-fit:cover;
 border-radius:10px;
 margin:15px 0;
}

/* TITLE */
#mTitle{
 font-size:22px;
 font-weight:700;
 margin-bottom:6px;
 color:#111;
}

/* CITY */
#mCity{
 font-size:14px;
 color:#666;
 margin-bottom:10px;
}

/* DESC */
#mDesc{
 font-size:15px;
 color:#333;
 line-height:1.6;
}

/* ================= ACTION BUTTONS ================= */
.modal-card button{
 padding:12px 22px;
 border:none;
 border-radius:10px;
 cursor:pointer;
 font-weight:600;
 margin-top:18px;
 margin-right:10px;
 transition:.25s;
}

/* APPROVE */
.modal-card button:first-of-type{
 background:linear-gradient(135deg,#16a34a,#22c55e);
 color:#fff;
}
.modal-card button:first-of-type:hover{
 transform:translateY(-2px);
 box-shadow:0 8px 20px rgba(34,197,94,.5);
}

/* REJECT */
.modal-card button:last-of-type{
 background:linear-gradient(135deg,#dc2626,#f87171);
 color:#fff;
}
.modal-card button:last-of-type:hover{
 transform:translateY(-2px);
 box-shadow:0 8px 20px rgba(248,113,113,.5);
}

/* ================= ADMIN MODAL ================= */
#createAdminModal .modal-card{
 max-width:420px;
}

.form-group{
 margin-bottom:16px;
}

.form-group label{
 font-weight:600;
 margin-bottom:6px;
 display:block;
}

.form-group input{
 width:100%;
 padding:12px;
 border-radius:10px;
 border:2px solid #e5e7eb;
 font-size:14px;
}

.form-group input:focus{
 outline:none;
 border-color:#3b82f6;
 box-shadow:0 0 0 3px rgba(59,130,246,.15);
}

/* CREATE BTN */
.btn-primary{
 width:100%;
 padding:13px;
 border:none;
 border-radius:12px;
 font-weight:600;
 cursor:pointer;
 background:linear-gradient(135deg,#2563eb,#3b82f6);
 color:white;
 transition:.25s;
}

.btn-primary:hover{
 transform:translateY(-2px);
 box-shadow:0 8px 20px rgba(59,130,246,.5);
}

/* ================= ANIMATIONS ================= */
@keyframes fadeIn{
 from{opacity:0}
 to{opacity:1}
}

@keyframes pop{
 from{transform:scale(.85);opacity:0}
 to{transform:scale(1);opacity:1}
}
/* NOTIFICATION */
.notify{
 position:fixed;
 top:15px;
 right:20px;
 background:#111;
 color:#fff;
 padding:10px 16px;
 border-radius:30px;
 cursor:pointer;
 z-index:9999;
}

.notify span{
 background:red;
 padding:2px 7px;
 border-radius:50%;
 font-size:12px;
}

/* TOAST */
.toast{
 position:fixed;
 bottom:20px;
 right:20px;
 background:#111;
 color:#fff;
 padding:14px 20px;
 border-radius:10px;
 opacity:0;
 transform:translateY(20px);
 transition:.3s;
 z-index:9999;
}

.toast.show{
 opacity:1;
 transform:translateY(0);
}

</style>
</head>

<body>
<!-- NOTIFICATION -->
<div id="notify" class="notify">
 üîî <span id="notifyCount">0</span>
</div>

<div id="toast" class="toast"></div>

<div class="layout">

<!-- SIDEBAR -->
<div class="side">
<h2 class="admin-title">
 <img src="/images/mediabuzz365.png" class="logo">
 <span>Super Admin</span>
</h2>

<button onclick="show('dashboard')">üìä Dashboard</button>
<button onclick="show('pending')">‚è≥ Pending News</button>
<button onclick="show('analytics')">üìà Analytics</button>
<button onclick="show('admins')">üë• Manage Admins</button>
<button class="danger" onclick="logout()">üö™ Logout</button>
    <button onclick="show('youtube')">
 üé• Manage YouTube
</button>

</div>

<!-- CONTENT -->
<div class="content">

<!-- DASHBOARD -->
<div id="dashboard" class="page">
 <h2>Dashboard</h2>
 <div class="stats">
  <div class="card">Total News <b id="total"></b></div>
  <div class="card">Pending <b id="pendingCount"></b></div>
  <div class="card">Approved <b id="approvedCount"></b></div>
 </div>
</div>
<div id="youtube" class="page">
 <h2>üé• YouTube Links</h2>

 <input id="yt1" placeholder="YouTube Link 1"><br><br>
 <input id="yt2" placeholder="YouTube Link 2"><br><br>
 <input id="yt3" placeholder="YouTube Link 3"><br><br>

 <button onclick="saveYoutube()">üíæ Save</button>
</div>

<!-- PENDING -->
<div id="pending" class="page">
 <h2>Pending News</h2>
 <div id="pendingList"></div>
</div>

<!-- ANALYTICS -->
<div id="analytics" class="page">
 <h2>Analytics</h2>
 <canvas id="chart"></canvas>
</div>

<!-- ADMINS -->
<div id="admins" class="page">
 <h2>üë• Admin Management</h2>
 <div id="adminList"></div>
</div>

</div>
</div>

<!-- NEWS MODAL -->
<div id="newsModal" class="modal">
 <div class="modal-card">
  <span class="close" onclick="closeModal()">√ó</span>
  <h2 id="mTitle"></h2>
  <p id="mCity"></p>
  <img id="mImage" style="width:100%;margin:15px 0">
  <p id="mDesc"></p>

  <button onclick="approve(currentId)">Approve</button>
  <button onclick="rejectNews(currentId)">Reject</button>
 </div>
</div>


<!-- ================= SOCKET.IO ================= -->
<script src="/socket.io/socket.io.js"></script>

<script>
/* SINGLE SOCKET CONNECTION */
const socket = io();

/* join super-admin room */
socket.emit("join","super-admin");

/* NEW PENDING NEWS */
socket.on("news:new",()=>{
 console.log("üü¢ new pending news");
 showNotify("üÜï New news submitted for approval");
 loadPending();
});

/* STATS UPDATE */
socket.on("stats:update",()=>{
 console.log("üìä stats updated");
 loadStats();
});

/* ADMIN REGISTER */
socket.on("admin:registered", data=>{
 showNotify(`üÜï New admin request: ${data.name}`);
});

/* APPROVE / REJECT */
socket.on("notify", data=>{
 if(data.type==="approve"){
  showNotify(`‚úÖ News approved: ${data.title}`);
 }
 if(data.type==="reject"){
  showNotify(`‚ùå News rejected`);
 }
});

/* UI TOAST */
function showNotify(msg){

 let count = document.getElementById("notifyCount");
 count.innerText = Number(count.innerText) + 1;

 const box = document.createElement("div");
 box.className="toast";
 box.innerText=msg;

 document.body.appendChild(box);

 setTimeout(()=>{
  box.remove();
 },4000);
}
    /* BELL CLICK */
document.getElementById("notify").onclick = ()=>{
 show("admins");

 localStorage.setItem("notifyCount",0);
 document.getElementById("notifyCount").innerText = 0;
};

    async function loadYoutube(){

 const res = await fetch(
  API+"/api/settings/youtube"
 );
 const data = await res.json();

 yt1.value=data[0]||"";
 yt2.value=data[1]||"";
 yt3.value=data[2]||"";
}

async function saveYoutube(){

 const links=[
  yt1.value,
  yt2.value,
  yt3.value
 ];

 await fetch(
  API+"/api/settings/youtube",
  {
   method:"POST",
   headers:{
    "Content-Type":"application/json",
    ...headers
   },
   body:JSON.stringify({links})
  }
 );

 alert("YouTube links updated");
}

</script>


<!-- MAIN LOGIC -->
<script src="super.js"></script>

</body>
</html>
